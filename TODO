TODO
Created Mon Dec  7 15:24:42 AKST 2015
Copyright (C) 2015 by Raymond E. Marcil <marcilr@gmail.com>



Repo use:
1. repo init -u "url"
2. repo sync


+++ Tue Dec  8 10:01:35 AKST 2015 - Get copy of google's manifest directory
and adapt to my own.

1. Clone google's common manifest for inspection:
Get copy of google's common manifest (references on Repo command reference):
https://android.googlesource.com/platform/manifest
tmp$ git clone https://android.googlesource.com/platform/manifest
Cloning into 'manifest'...
remote: Counting objects: 252, done
remote: Finding sources: 100% (252/252)
remote: Total 3162 (delta 985), reused 3162 (delta 985)
Receiving objects: 100% (3162/3162), 1.73 MiB | 2.73 MiB/s, done.
Resolving deltas: 100% (986/986), done.
Checking connectivity... done.
covellite:~/tmp$

Looks like manifest repo with only default.xml and standard .git/
subdirectory.

2. Create my own manifest git repository:
$ mkdir manifest
$ cd manifest
$ git init
Initialized empty Git repository in /home/marcilr/tmp/tmp2/manifest/.git/
$ github-create
Repo name (hit enter to use 'manifest')?
<enter>
Creating Github repository 'manifest' ... done.
Pushing local code to remote ... done.
$

3. Check manifiest repo to verify creation:
$ cd ..
$ rm -rf manifest
$ git clone git@github.com:marcilr/manifest.git manifest
Cloning into 'manifest'...
warning: You appear to have cloned an empty repository.
Checking connectivity... done.
$

Looks good.

4. Create and add default manifest:
$ cd manifest

Create default.xml

$ git add default.xml
$ git commit -m "Default manifest" default.xml
 1 file changed, 19 insertions(+)
 create mode 100644 default.xml
$

Push default manifest to GitHub:$ git push
Counting objects: 3, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (3/3), 495 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
To git@github.com:marcilr/manifest.git
 * [new branch]      master -> master
$


+++ Tue Dec  8 09:02:08 AKST 2015 - Use repo init -u to   <=== working
checkout GitHub repository.                                               


Try against new manifest repo:
$ repo --trace init -u git@github.com:marcilr/manifest.git
Get https://gerrit.googlesource.com/git-repo/clone.bundle
Get https://gerrit.googlesource.com/git-repo
remote: Finding sources: 100% (10/10)
remote: Total 10 (delta 1), reused 10 (delta 1)
Unpacking objects: 100% (10/10), done.
From https://gerrit.googlesource.com/git-repo
   74cfd27..e9becc0  master     -> origin/master
: git --version 1>| 2>|
: parsing /home/marcilr/.gitconfig
Get git@github.com:marcilr/manifest.git
: export GIT_DIR=/home/marcilr/tmp/tmp3/.repo/manifests.git
: git init 1>| 2>|
: git config --file /home/marcilr/tmp/tmp3/.repo/manifests.git/config \
--null --list 1>| 2>|
: git config --file /home/marcilr/tmp/tmp3/.repo/manifests.git/config \
--unset-all core.bare 1>| 2>|
: git config --file /home/marcilr/tmp/tmp3/.repo/manifests.git/config \
--replace-all remote.origin.url git@github.com:marcilr/manifest.git 1>| 2>|
: git config --file /home/marcilr/tmp/tmp3/.repo/manifests.git/config \
--replace-all remote.origin.fetch +refs/heads/*:refs/remotes/origin/* 1>| 2>|
: ssh -o ControlPath /tmp/ssh-inWCLs/master-%r@%h:%p git@github.com -O check
: ssh -M -N -o ControlPath /tmp/ssh-inWCLs/master-%r@%h:%p git@github.com
: git fetch --progress origin --tags +refs/heads/*:refs/remotes/origin/* \
+refs/heads/master:refs/remotes/origin/master 1>| 2>|
remote: Counting objects: 3, done.        
remote: Compressing objects: 100% (2/2), done.        
remote: Total 3 (delta 0), reused 3 (delta 0), pack-reused 0        
From github.com:marcilr/manifest
 * [new branch]      master     -> origin/master
: git pack-refs --all --prune 1>| 2>|
: git rev-parse --verify refs/remotes/origin/master^0 1>| 2>|

: cd /home/marcilr/tmp/tmp3/.repo/manifests
: git read-tree --reset -u -v HEAD 1>| 2>|
: load refs /home/marcilr/tmp/tmp3/.repo/manifests.git
: scan refs /home/marcilr/tmp/tmp3/.repo/manifests.git

Your identity is: Raymond Marcil <marcilr@gmail.com>
If you want to change this, please re-run 'repo init' with --config-name

repo has been initialized in /home/marcilr/tmp/tmp3
$

This checked out to the current working directory with
.repo subdirectory.  The .repo directory has manifests/default.xml
and .repo/manifest.xml symlink to ./repo/manifest/default.xml


$ repo sync
Fetching project marcilr/foo.git
remote: Counting objects: 11, done.        
remote: Total 11 (delta 0), reused 0 (delta 0), pack-reused 9        
From ssh://github.com/marcilr/foo
 * [new branch]      master     -> origin/master
Fetching projects: 100% (1/1), done.  

$

This checked out the GitHub foo repo to projects/foo in the 
current working directory.

I've got the repo command working!


Works:
$ git clone git@github.com:marcilr/foo.git foo




+++ Tue Dec  8 08:38:33 AKST 2015 - Use repo init -u to checkout GitHub
.repo with the required:
  ./repo/manifest.xml -> manifests/default.xml
  ./repo/manifests/default.xml

$ repo init -u ssh://github.com/marcilr/.repo
Get https://gerrit.googlesource.com/git-repo/clone.bundle
Get https://gerrit.googlesource.com/git-repo
remote: Finding sources: 100% (10/10)
remote: Total 10 (delta 1), reused 10 (delta 1)
Unpacking objects: 100% (10/10), done.
From https://gerrit.googlesource.com/git-repo
   74cfd27..e9becc0  master     -> origin/master
Get ssh://github.com/marcilr/.repo
remote: Counting objects: 7, done.        
remote: Total 7 (delta 0), reused 0 (delta 0), pack-reused 7        
From ssh://github.com/marcilr/.repo
 * [new branch]      master     -> origin/master
fatal: manifest 'default.xml' not available
fatal: manifest default.xml not found
marcilr@covellite:~/tmp/tmp3$ 

Looks like default.xml is checked out under:
  .repo/manifests/manifests/default.xml

Likely using repo to checkout a .repo repository is problematic.


+++ Tue Dec  8 08:26:54 AKST 2015 - Get GitHub .repo repository working:
 
$ git clone git@github.com:marcilr/.repo.git .repo
Cloning into '.repo'...
remote: Counting objects: 3, done.
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 3
Receiving objects: 100% (3/3), done.
Checking connectivity... done.
$

Creates .repo directory.  However it ownly has:
manifest.xml -> manifests/default.xml

Does not have manifests/default.xml file.

1. Create manifests/ subdirectory with default.xml file.
.repo$ mkdir manifests

Create .repo/manifests/default.xml (that has .repo/manifest.xml symlink)

2. Commit default.xml manifest
.repo$ git commit -m "default.xml manifest with .repo/manifest.xml symlink" \
manifests/default.xml
[master 8a62fd5] default.xml manifest with .repo/manifest.xml symlink
 1 file changed, 19 insertions(+)
 create mode 100644 manifests/default.xml
.repo$

3. Push to GitHub
.repo$ git push                                    Counting objects: 4, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 624 bytes | 0 bytes/s, done.
Total 4 (delta 0), reused 0 (delta 0)
To git@github.com:marcilr/.repo.git
   14b7d35..8a62fd5  master -> master
.repo$

4. Check status
.repo$ git status
On branch master
Your branch is up-to-date with 'origin/master'.
nothing to commit, working directory clean
.repo$

5. Create new tmp directory and verify updated .repo:

$ mkdir tmp
$ cd tmp
tmp$ git clone git@github.com:marcilr/.repo.git .repo  Cloning into '.repo'...
remote: Counting objects: 7, done.
remote: Total 7 (delta 0), reused 0 (delta 0), pack-reused 7
Receiving objects: 100% (7/7), done.
Checking connectivity... done.
tmp$ 

tmp$ ls .repo/manifests/default.xml 
.repo/manifests/default.xml
tmp$

The GitHub .repo repository is fixed.


+++ Mon Dec  7 15:24:42 AKST 2015 - Checkout GitHb repo using 
repo init syntax and manifest.


$ repo init -u ssh://github.com/marcilr/.repo
Get https://gerrit.googlesource.com/git-repo/clone.bundle
Get https://gerrit.googlesource.com/git-repo
remote: Finding sources: 100% (10/10)
remote: Total 10 (delta 1), reused 10 (delta 1)
Unpacking objects: 100% (10/10), done.
From https://gerrit.googlesource.com/git-repo
   74cfd27..e9becc0  master     -> origin/master
Get ssh://github.com/marcilr/.repo
remote: Counting objects: 3, done.        
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 3        
From ssh://github.com/marcilr/.repo
 * [new branch]      master     -> origin/master
fatal: manifest 'default.xml' not available
fatal: manifest default.xml not found
$


$ repo init -u ssh://github.com/marcilr/foo
Get https://gerrit.googlesource.com/git-repo/clone.bundle
Get https://gerrit.googlesource.com/git-repo
remote: Finding sources: 100% (10/10)
remote: Total 10 (delta 1), reused 10 (delta 1)
Unpacking objects: 100% (10/10), done.
From https://gerrit.googlesource.com/git-repo
   74cfd27..e9becc0  master     -> origin/master
Get ssh://github.com/marcilr/foo
fatal: Couldn't find remote ref refs/heads/master
fatal: Couldn't find remote ref refs/heads/master
fatal: cannot obtain manifest ssh://github.com/marcilr/foo
$

The above did create a .repo subdirectory.


repo init -u ssh://github.com/marcilr/.repo -m .repo/manifests/default.xml
...
From ssh://github.com/marcilr/.repo
 * [new branch]      master     -> origin/master
fatal: manifest '.repo/manifests/default.xml' not available
fatal: manifest .repo/manifests/default.xml not found

covellite:~/tmp/tmp2$ repo init -u ssh://github.com/marcilr/.repo -m manifest.xml
Get https://gerrit.googlesource.com/git-repo/clone.bundle
Get https://gerrit.googlesource.com/git-repo
remote: Finding sources: 100% (10/10)
remote: Total 10 (delta 1), reused 10 (delta 1)
Unpacking objects: 100% (10/10), done.
From https://gerrit.googlesource.com/git-repo
   74cfd27..e9becc0  master     -> origin/master
Get ssh://github.com/marcilr/.repo
remote: Counting objects: 3, done.        
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 3        
From ssh://github.com/marcilr/.repo
 * [new branch]      master     -> origin/master
fatal: manifest 'manifest.xml' not available
fatal: manifest manifest.xml not found
covellite:~/tmp/tmp2$

Much closer to working with ssh configured right.


+++ Mon Dec  7 15:24:42 AKST 2015 - Merge git commit details from:
2.3 Git Basics - Viewing the Commit History
https://git-scm.com/book/en/v2/Git-Basics-Viewing-the-Commit-History


+++ Tue Dec  8 09:37:48 AKST 2015 - Add removing subdirectory section:

foo$ git commit -m "Removing .repo subdirectory." .repo
[master 818f97a] Removing .repo subdirectory.
 2 files changed, 20 deletions(-)
 delete mode 120000 .repo/manifest.xml
 delete mode 100644 .repo/manifests/default.xml
foo$

foo$ git push
Counting objects: 2, done.
Writing objects: 100% (2/2), 212 bytes | 0 bytes/s, done.
Total 2 (delta 0), reused 0 (delta 0)
To git@github.com:marcilr/foo.git
   6aa954a..818f97a  master -> master
foo$ 

Remove directory from git but NOT local
---------------------------------------
As mentioned in the comments, what you usually want to do is remove
this directory from git but not delete it entirely from the
filesystem (local)
In that case use:

git rm -r --cached myFolder

How to remove a directory in my GitHub repository?
http://stackoverflow.com/questions/6313126/how-to-remove-a-directory-in-my-github-repository


Complete
========
x Tue Dec  8 08:09:15 AKST 2015 - Clone repository with ssh and crypto keys:

On GitHub public key configured under:
  Settings > SSH Keys

rsa4096_github_nopassphrase.pub
  On GitHub public key configured under:
    Settings > SSH Keys

.ssh/
rsa4096_github_nopassphrase
rsa4096_github_nopassphrase.pub

.ssh/config:
host github.com
$ git clone git@github.com:marcilr/foo.git foo
    Hostname github.com
    User git
    IdentityFile ~/.ssh/rsa4096_github_nopassphrase
    IdentitiesOnly yes
    ServerAliveInterval 120

covellite:~/tmp$ git clone git@github.com:marcilr/foo.git foo
Cloning into 'foo'...
warning: You appear to have cloned an empty repository.
Checking connectivity... done.
marcilr@covellite:~/tmp
$




Links
=====
git-repo
repo - The multiple repository tool
https://code.google.com/p/git-repo/

How does the Android repo manifest repository work?
Has good details here <=== Should mirror.
http://stackoverflow.com/questions/6149725/how-does-the-android-repo-manifest-repository-work

Is there any way to clone a git repository's sub-directory only?
This is called a sparse checkout, available since version 1.7.0.
http://stackoverflow.com/questions/600079/is-there-any-way-to-clone-a-git-repositorys-sub-directory-only/13738951#13738951
http://stackoverflow.com/a/13738951/278405

Repo: Tips & Tricks
xda university
Some good tricks here
http://xda-university.com/as-a-developer/repo-tips-tricks

Repo command reference
http://source.android.com/source/using-repo.html

Repo manifest format
https://gerrit.googlesource.com/git-repo/+/master/docs/manifest-format.txt

Using Google's repo command in your own projects
by wroberts3
http://www.instructables.com/id/Using-Googles-repo-command-in-your-own-projects/
